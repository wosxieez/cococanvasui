!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.cocoui=e():t.cocoui=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}t.d(e,{default:()=>w});var a=n((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}));function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="UIComponent",this._application=null,this._x=0,this._y=0,this._width=50,this._height=50,this.children=[],this.initialized=!1,this.invalidatePropertiesFlag=!1,this.invalidateDisplayListFlag=!1,this.invalidaetSkinFlag=!1,this.invalidateRenderFlag=!1,this.callLaterMethods=[]}var e,i;return e=t,i=[{key:"x",get:function(){return this._x},set:function(t){t=Math.ceil(t),this._x!=t&&(this._x=t,this.invalidateDisplayList(),this.invalidateSkin())}},{key:"y",get:function(){return this._y},set:function(t){t=Math.ceil(t),this._y!=t&&(this._y=t,this.invalidateDisplayList(),this.invalidateSkin())}},{key:"width",get:function(){return this._width},set:function(t){t=Math.ceil(t),this._width!=t&&(this._width=t,this.invalidateDisplayList(),this.invalidateSkin())}},{key:"height",get:function(){return this._height},set:function(t){t=Math.ceil(t),this._height!=t&&(this._height=t,this.invalidateDisplayList(),this.invalidateSkin())}},{key:"application",get:function(){return this._application},set:function(t){this._application!=t&&(this._application=t,this.pushCallLaterMethodsToApplicationCallLaterMethods(),this.setChildrenApplication())}},{key:"initialize",value:function(){this.initialized||(this.createChildren(),this.invalidatePropertiesInLifeCycle(),this.invalidateDisplayListInLifeCycle(),this.invalidateSkinInLifeCycle(),this.initialized=!0)}},{key:"createChildren",value:function(){}},{key:"invalidatePropertiesInLifeCycle",value:function(){this.invalidatePropertiesFlag||(this.invalidatePropertiesFlag=!0,this.callLaterInLifeCycle(this.validateProperties,0).descript="[core] validateProperties()")}},{key:"invalidateDisplayListInLifeCycle",value:function(){this.invalidateDisplayListFlag||(this.invalidateDisplayListFlag=!0,this.callLaterInLifeCycle(this.validateDisplayList,2).descript="[core] validateDisplayList()")}},{key:"invalidateSkinInLifeCycle",value:function(){this.invalidaetSkinFlag||(this.invalidaetSkinFlag=!0,this.callLaterInLifeCycle(this.validateSkin,3).descript="[core] validateSkin()")}},{key:"invalidateProperties",value:function(){!this.invalidatePropertiesFlag&&this.initialized&&(this.invalidatePropertiesFlag=!0,this.callLater(this.validateProperties).descript="validateProperties()")}},{key:"invalidateDisplayList",value:function(){!this.invalidateDisplayListFlag&&this.initialized&&(this.invalidateDisplayListFlag=!0,this.callLater(this.validateDisplayList).descript="validateDisplayList()")}},{key:"invalidateSkin",value:function(){!this.invalidaetSkinFlag&&this.initialized&&(this.invalidaetSkinFlag=!0,this.callLater(this.validateSkin).descript="validateSkin()")}},{key:"invalidateRender",value:function(){!this.invalidateRenderFlag&&this.initialized&&(this.invalidateRenderFlag=!0,this.callLater(this.validateRender).descript="[core] validateRender()")}},{key:"validateNow",value:function(){this.validateProperties(),this.validateDisplayList(),this.validateSkin()}},{key:"validateProperties",value:function(){this.invalidatePropertiesFlag&&(this.invalidatePropertiesFlag=!1,this.commitProperties())}},{key:"validateDisplayList",value:function(){this.invalidateDisplayListFlag&&(this.invalidateDisplayListFlag=!1,this.updateDisplayList())}},{key:"validateSkin",value:function(){this.invalidaetSkinFlag&&(this.invalidaetSkinFlag=!1,this.application&&this.application.invalidateRender())}},{key:"validateRender",value:function(){this.invalidateRenderFlag&&(this.invalidateRenderFlag=!1,this.render())}},{key:"commitProperties",value:function(){}},{key:"updateDisplayList",value:function(){}},{key:"render",value:function(e){if(e){var i;this.drawSkin(e);for(var n=0;n<this.children.length;n++)(i=this.children[n])instanceof t&&i.render(e)}}},{key:"drawSkin",value:function(t){t.lineWidth=1,t.strokeStyle="#000000",t.strokeRect(this.x,this.y,this.width,this.height)}},{key:"setChildrenApplication",value:function(){for(var e,i=0;i<this.children.length;i++)(e=this.children[i])instanceof t&&(e.application=application)}},{key:"callLater",value:function(t){var e=new a;e.method=t;for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return e.args=n,e.caller=this,this.application?this.application.pushCallLaterMethodToApplicationCallLaterMethods(e):this.callLaterMethods.push(e),e}},{key:"callLaterInLifeCycle",value:function(t,e){var i=new a;i.method=t;for(var n=arguments.length,r=new Array(n>2?n-2:0),l=2;l<n;l++)r[l-2]=arguments[l];return i.args=r,i.caller=this,this.callLaterMethods.splice(e,0,i),i}},{key:"pushCallLaterMethodsToApplicationCallLaterMethods",value:function(){if(this.application)for(;this.callLaterMethods.length>0;)this.application.pushCallLaterMethodToApplicationCallLaterMethods(this.callLaterMethods.shift())}},{key:"addChild",value:function(e){return e instanceof t&&(this.children.push(e),e.initialize(),e.application=application),e}}],i&&r(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=h(t,e);if(n){var a=Object.getOwnPropertyDescriptor(n,e);return a.get?a.get.call(arguments.length<3?t:i):a.value}},c.apply(this,arguments)}function h(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function f(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=g(t,e);if(n){var a=Object.getOwnPropertyDescriptor(n,e);return a.get?a.get.call(arguments.length<3?t:i):a.value}},v.apply(this,arguments)}function g(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}function b(t,e){return b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},b(t,e)}function L(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}const w={UIComponent:l,Application:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(l,t);var e,i,n,a,r=(n=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(a){var i=p(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return f(this,t)});function l(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this)).name="Application",t._width=800,t._height=600,t.invalidateCallLaterFlag=!1,t.invalidateRenderFlag=!1,t}return e=l,(i=[{key:"initialize",value:function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height,document.body.appendChild(t),this.application=this,this.context=t.getContext("2d"),c(p(l.prototype),"initialize",this).call(this)}},{key:"pushCallLaterMethodToApplicationCallLaterMethods",value:function(t){this.callLaterMethods.push(t),this.invalidateCallLater()}},{key:"pushCallLaterMethodsToApplicationCallLaterMethods",value:function(){}},{key:"invalidateCallLater",value:function(){var t=this;this.initialized&&!this.invalidateCallLaterFlag&&(this.invalidateCallLaterFlag=!0,setTimeout((function(){t.validateCallLater()}),0))}},{key:"validateCallLater",value:function(){this.invalidateCallLaterFlag&&this.updateCallLater()}},{key:"updateCallLater",value:function(){if(0!=this.callLaterMethods.length){for(var t;this.callLaterMethods.length>0;)t=this.callLaterMethods.shift(),console.log(t.caller.name,t.descript),t.method.apply(t.caller,t.args);this.invalidateCallLaterFlag=!1}}},{key:"render",value:function(){this.context.clearRect(this.x,this.y,this.width,this.height),c(p(l.prototype),"render",this).call(this,this.context)}}])&&s(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),l}(l),Button:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(l,t);var e,i,n,a,r=(n=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=k(n);if(a){var i=k(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return L(this,t)});function l(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this)).name="Button",t._width=70,t._height=30,t._label=null,t}return e=l,(i=[{key:"label",get:function(){return this._label},set:function(t){this._label!=t&&(this._label=t,this.invalidateProperties(),this.invalidateSkin())}},{key:"drawSkin",value:function(t){v(k(l.prototype),"drawSkin",this).call(this,t),t.font="12px Georgia",t.fillText(this.label||this.name,this.x,this.y+this.height)}}])&&y(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),l}(l)};return e.default})()}));
//# sourceMappingURL=cocoui.js.map